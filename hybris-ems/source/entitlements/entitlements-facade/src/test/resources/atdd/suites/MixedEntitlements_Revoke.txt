*** Settings ***
Resource    entitlements-test/settings_keywords.txt
Resource    entitlements-test/builder_entitlements_keywords.txt
Resource    entitlements-test/modify_entitlements_keywords.txt
Resource    entitlements-test/exceptions_entitlements_keywords.txt
Resource    entitlements-test/check_entitlements_keywords.txt
Resource    entitlements-test/use_entitlements_keywords.txt

*** Test Cases ***

###### METERED + STRING:
### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE + GRANT_SOURCE_ID:

Test_MixedEntitlements_Revoke_MeteredAndStringConditionType
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_STR}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource}" and grantSourceId "${grantSourceId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_Revoke_MeteredAndStringConditionType_x2
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...ENT1
    ${entitlement1}=    grant entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    #...ENT2
    ${entitlement2}=    grant entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    ### REVOKE WITH CORRECT PARAMETERS:
    #...REVOKE ENT1
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #...ENT2 exists still:
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    #...REVOKE ENT2
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

### REVOKE BY USERID ONLY:

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringConditionType_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_STR}" to entitlement "${entitlement}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringConditionType_x2_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...GRANT ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringConditionType_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${userId1} =     generate random id
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2 FOR USER2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER1
    revoke entitlements for user "${userId1}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER2
    revoke entitlements for user "${userId2}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId2}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringConditionType_Multi
    [Documentation]    Revoke grants using only user ID (US6310)
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${entitlementType3}      Set Variable    ENT_MIXED_3
    ${userId1} =       generate random id
    ${userId2} =       generate random id
    ${userId3} =       generate random id
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_STR}" for user "${userId3}"
    ensure there are "3" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 1
    revoke entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 3
    revoke entitlements for user "${userId3}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"
    #...REVOKE FOR USER 2
    revoke entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId2}"
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"

### REVOKE BY USERID + ENTITLEMENT_TYPE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementType_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${entitlementType_Incorrect}      Set Variable    ENT_MIXED_INCORRECT
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
     add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
     add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT ENTITLEMENT_TYPE FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSource_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSourceId_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSource_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceAndGrantSourceId_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE AND GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceId_MeteredAndStringConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

###### METERED + PATH:
### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE + GRANT_SOURCE_ID:
Test_MixedEntitlements_Revoke_MeteredAndPathConditionType
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource}" and grantSourceId "${grantSourceId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_Revoke_MeteredAndPathConditionType_x2
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...ENT1
    ${entitlement1}=    grant entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    #...ENT2
    ${entitlement2}=    grant entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    ### REVOKE WITH CORRECT PARAMETERS:
    #...REVOKE ENT1
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #...ENT2 exists still:
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    #...REVOKE ENT2
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

### REVOKE BY USERID ONLY:

Test_MixedEntitlements_RevokeByUserId_MeteredAndPathConditionType_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndPathConditionType_x2_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...GRANT ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndPathConditionType_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${userId1} =     generate random id
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2 FOR USER2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER1
    revoke entitlements for user "${userId1}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER2
    revoke entitlements for user "${userId2}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId2}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndPathConditionType_Multi
    [Documentation]    Revoke grants using only user ID (US6310)
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${entitlementType3}      Set Variable    ENT_MIXED_3
    ${userId1} =       generate random id
    ${userId2} =       generate random id
    ${userId3} =       generate random id
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    ensure there are "3" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 1
    revoke entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 3
    revoke entitlements for user "${userId3}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"
    #...REVOKE FOR USER 2
    revoke entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId2}"
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"

### REVOKE BY USERID + ENTITLEMENT_TYPE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementType_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${entitlementType_Incorrect}      Set Variable    ENT_MIXED_INCORRECT
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
     add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
     add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT ENTITLEMENT_TYPE FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSource_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSourceId_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSource_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceAndGrantSourceId_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE AND GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceId_MeteredAndPathConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_PATH}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_PATH}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

###### METERED + TIME:
### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE + GRANT_SOURCE_ID:
Test_MixedEntitlements_Revoke_MeteredAndTimeConditionType
    #ConditionType_TimeframeAndPathAndTimeCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource}" and grantSourceId "${grantSourceId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_Revoke_MeteredAndTimeConditionType_x2
    #ConditionType_TimeframeAndPathAndTimeCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...ENT1
    ${entitlement1}=    grant entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    #...ENT2
    ${entitlement2}=    grant entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    ### REVOKE WITH CORRECT PARAMETERS:
    #...REVOKE ENT1
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #...ENT2 exists still:
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    #...REVOKE ENT2
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

### REVOKE BY USERID ONLY:

Test_MixedEntitlements_RevokeByUserId_MeteredAndTimeConditionType_1User
    #ConditionType_TimeframeAndPathAndTimeCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndTimeConditionType_x2_1User
    #ConditionType_TimeframeAndPathAndTimeCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...GRANT ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndTimeConditionType_2Users
    #ConditionType_TimeframeAndPathAndTimeCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${userId1} =     generate random id
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2 FOR USER2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER1
    revoke entitlements for user "${userId1}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER2
    revoke entitlements for user "${userId2}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId2}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndTimeConditionType_Multi
    [Documentation]    Revoke grants using only user ID (US6310)
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${entitlementType3}      Set Variable    ENT_MIXED_3
    ${userId1} =       generate random id
    ${userId2} =       generate random id
    ${userId3} =       generate random id
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_TIME}" for user "${userId3}"
    ensure there are "3" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 1
    revoke entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 3
    revoke entitlements for user "${userId3}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"
    #...REVOKE FOR USER 2
    revoke entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId2}"
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"

### REVOKE BY USERID + ENTITLEMENT_TYPE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementType_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${entitlementType_Incorrect}      Set Variable    ENT_MIXED_INCORRECT
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
     add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
     add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT ENTITLEMENT_TYPE FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSource_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSourceId_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSource_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceAndGrantSourceId_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE AND GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceId_MeteredAndTimeConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_TIME}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_TIME}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

###### METERED + GEO:
### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE + GRANT_SOURCE_ID:
Test_MixedEntitlements_Revoke_MeteredAndGeoConditionType
    #ConditionType_TimeframeAndPathAndGeoCondition
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource}" and grantSourceId "${grantSourceId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_Revoke_MeteredAndGeoConditionType_x2
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...ENT1
    ${entitlement1}=    grant entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    #...ENT2
    ${entitlement2}=    grant entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    ### REVOKE WITH CORRECT PARAMETERS:
    #...REVOKE ENT1
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #...ENT2 exists still:
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    #...REVOKE ENT2
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

### REVOKE BY USERID ONLY:

Test_MixedEntitlements_RevokeByUserId_MeteredAndGeoConditionType_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndGeoConditionType_x2_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...GRANT ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndGeoConditionType_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${userId1} =     generate random id
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2 FOR USER2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER1
    revoke entitlements for user "${userId1}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER2
    revoke entitlements for user "${userId2}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId2}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndGeoConditionType_Multi
    [Documentation]    Revoke grants using only user ID (US6310)
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${entitlementType3}      Set Variable    ENT_MIXED_3
    ${userId1} =       generate random id
    ${userId2} =       generate random id
    ${userId3} =       generate random id
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_GEO}" for user "${userId3}"
    ensure there are "3" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 1
    revoke entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 3
    revoke entitlements for user "${userId3}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"
    #...REVOKE FOR USER 2
    revoke entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId2}"
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"

### REVOKE BY USERID + ENTITLEMENT_TYPE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementType_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${entitlementType_Incorrect}      Set Variable    ENT_MIXED_INCORRECT
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
     add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
     add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT ENTITLEMENT_TYPE FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSource_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSourceId_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSource_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceAndGrantSourceId_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE AND GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceId_MeteredAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_GEO}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

###### METERED + STRING+PATH+TIME+GEO:
### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE + GRANT_SOURCE_ID:
Test_MixedEntitlements_Revoke_MeteredAndStringAndPathAndTimeAndGeoConditionType
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_STR}" to entitlement "${entitlement}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource}" and grantSourceId "${grantSourceId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_Revoke_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...ENT1
    ${entitlement1}=    grant entitlement "${entitlement1}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    #...ENT2
    ${entitlement2}=    grant entitlement "${entitlement2}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    ### REVOKE WITH CORRECT PARAMETERS:
    #...REVOKE ENT1
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    #...ENT2 exists still:
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    #...REVOKE ENT2
    revoke entitlement for user "${userId}" and entitlementType "${entitlementType}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

### REVOKE BY USERID ONLY:

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringAndPathAndTimeAndGeoConditionType_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType}      Set Variable    ENT_MIXED
    ${grantSource}      Set Variable    grantSource_1
    ${grantSourceId}      Set Variable    grantSourceId_1
    ${userId} =     generate random id
    ${entitlement}=    create entitlement with entitlementType "${entitlementType}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement}"
    add condition "${GRANT_STR}" to entitlement "${entitlement}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement}"
    assign grantSourceId "${grantSourceId}" to entitlement "${entitlement}"
    assign grantSource "${grantSource}" to entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    ${entitlement}=    grant entitlement "${entitlement}"
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType}" and grantSource "${grantSource}", grantSourceId "${grantSourceId}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_1User
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    #...GRANT ENT1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER
    revoke entitlements for user "${userId}"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId}" is "false"
    ensure there are "0" entitlements for user "${userId}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringAndPathAndTimeAndGeoConditionType_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${userId1} =     generate random id
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement1}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement1}"
    add condition "${GRANT_STR}" to entitlement "${entitlement1}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement1}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement1}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement1}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement1}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement1}"
    ${entitlement1}=    grant entitlement "${entitlement1}"
    #...GRANT ENT2 FOR USER2
    ${entitlement2}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement2}"
    add condition "${GRANT_STR}" to entitlement "${entitlement2}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement2}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement2}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement2}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement2}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement2}"
    ${entitlement2}=    grant entitlement "${entitlement2}"
    #...CHECK ENTITLEMENT(S) FOR USER(S)
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER1
    revoke entitlements for user "${userId1}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    #...REVOKE ENTITLEMENTS FOR USER2
    revoke entitlements for user "${userId2}"
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId2}"

Test_MixedEntitlements_RevokeByUserId_MeteredAndStringAndPathAndTimeAndGeoConditionType_Multi
    [Documentation]    Revoke grants using only user ID (US6310)
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "0", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${entitlementType3}      Set Variable    ENT_MIXED_3
    ${userId1} =       generate random id
    ${userId2} =       generate random id
    ${userId3} =       generate random id
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId1}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId2}"
    grant entitlement with entitlementType "${entitlementType1}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType2}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    grant entitlement with entitlementType "${entitlementType3}" and conditions "${GRANT_METERED}|${GRANT_PATH}" for user "${userId3}"
    ensure there are "3" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 1
    revoke entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are "3" entitlements for user "${userId3}"
    #...REVOKE FOR USER 3
    revoke entitlements for user "${userId3}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are "3" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"
    #...REVOKE FOR USER 2
    revoke entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId1}"
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId2}"
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId3}"
    ensure there are "0" entitlements for user "${userId3}"

### REVOKE BY USERID + ENTITLEMENT_TYPE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementType_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${entitlementType_Incorrect}      Set Variable    ENT_MIXED_INCORRECT
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT ENTITLEMENT_TYPE FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType_Incorrect}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType_Incorrect}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE ONLY:

Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSource_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + ENTITLEMENT_TYPE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndEntitlementTypeAndGrantSourceId_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and entitlementType "${entitlementType2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and entitlementType "${entitlementType1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSource_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceAndGrantSourceId_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSource_Incorrect}      Set Variable    grantSource_Incorrect
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE AND GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSource "${grantSource_Incorrect}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource_Incorrect}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSource "${grantSource2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSource "${grantSource1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"

### REVOKE BY USERID + GRANT_SOURCE_ID ONLY:
Test_MixedEntitlements_RevokeByUserIdAndGrantSourceId_MeteredAndStringAndPathAndTimeAndGeoConditionType_x2_2Users
    [Documentation]    Entitlement with filters
    ${GRANT_METERED} =         Set Variable        "metered" condition with parameters {"maxQuantity": "2", "allowOverage" : "true"}
    ${CHECK_METERED} =         Set Variable        "metered" condition with parameters {"quantity": "1"}
    ${GRANT_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${CHECK_STR}    Set Variable    "string" condition with parameters {"string":"abc"}
    ${GRANT_PATH}    Set Variable    "path" condition with parameters {"path":"/root"}
    ${CHECK_PATH}    Set Variable    "path" condition with parameters {"file":"/root"}
	${GRANT_TIME}    Set Variable    "timeframe" condition with parameters {"startTime":"2010-01-01T00:00:00Z","endTime":"2010-01-01T00:00:02Z"}
    ${CHECK_TIME}    Set Variable    "timeframe" condition with parameters {"time":"2010-01-01T00:00:01Z"}
    ${GRANT_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${CHECK_GEO}    Set Variable    "geo" condition with parameters {"geoPath":"Germany/Bavaria/Munich"}
    ${entitlementType1}      Set Variable    ENT_MIXED_1
    ${grantSource1}      Set Variable    grantSource_1
    ${grantSourceId_Incorrect}      Set Variable    grantSourceId_Incorrect
    ${grantSourceId1}      Set Variable    grantSourceId_1
    ${entitlementType2}      Set Variable    ENT_MIXED_2
    ${grantSource2}      Set Variable    grantSource_2
    ${grantSourceId2}      Set Variable    grantSourceId_2
    ${userId1} =     generate random id
    ${userId2} =     generate random id
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    #...GRANT ENT1 FOR USER1
    ${entitlement11}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement11}"
    add condition "${GRANT_STR}" to entitlement "${entitlement11}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement11}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement11}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement11}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement11}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement11}"
    ${entitlement11}=    grant entitlement "${entitlement11}"
    #...GRANT ENT2 FOR USER1
    ${entitlement12}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId1}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement12}"
    add condition "${GRANT_STR}" to entitlement "${entitlement12}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement12}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement12}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement12}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement12}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement12}"
    ${entitlement12}=    grant entitlement "${entitlement12}"
    #...GRANT ENT1 FOR USER2
    ${entitlement21}=    create entitlement with entitlementType "${entitlementType1}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement21}"
    add condition "${GRANT_STR}" to entitlement "${entitlement21}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement21}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement21}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement21}"
    assign grantSourceId "${grantSourceId1}" to entitlement "${entitlement21}"
    assign grantSource "${grantSource1}" to entitlement "${entitlement21}"
    ${entitlement21}=    grant entitlement "${entitlement21}"
    #...GRANT ENT2 FOR USER2
    ${entitlement22}=    create entitlement with entitlementType "${entitlementType2}" for user "${userId2}"
    add condition "${GRANT_METERED}" to entitlement "${entitlement22}"
    add condition "${GRANT_STR}" to entitlement "${entitlement22}"
    add condition "${GRANT_PATH}" to entitlement "${entitlement22}"
    add condition "${GRANT_TIME}" to entitlement "${entitlement22}"
    add condition "${GRANT_GEO}" to entitlement "${entitlement22}"
    assign grantSourceId "${grantSourceId2}" to entitlement "${entitlement22}"
    assign grantSource "${grantSource2}" to entitlement "${entitlement22}"
    ${entitlement22}=    grant entitlement "${entitlement22}"
    ######
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE INCORRECT GRANT_SOURCE_ID FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId_Incorrect}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSourceId1}", grantSourceId "${grantSourceId_Incorrect}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "true" in DB
    ensure there are "2" entitlements for user "${userId1}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "2" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "true"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "true" in DB
    ensure there are "1" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE2 FOR USER2
    revoke entitlements for user "${userId2}" and grantSourceId "${grantSourceId2}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "true"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "true" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "1" entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" and conditions "${CHECK_METERED}|${CHECK_STR}|${CHECK_PATH}|${CHECK_TIME}|${CHECK_GEO}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ######
    #...REVOKE ENTITLEMENT_TYPE1 FOR USER1
    revoke entitlements for user "${userId1}" and grantSourceId "${grantSourceId1}"
    #...CHECK ENTITLEMENT(S) FOR USER1
    check entitlement with entitlementType "${entitlementType1}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId1}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId1}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId1}" is "false" in DB
    ensure there are "0" entitlements for user "${userId1}"
    ensure there are no entitlements for user "${userId1}"
    #...CHECK ENTITLEMENT(S) FOR USER2
    check entitlement with entitlementType "${entitlementType1}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType1}" and grantSource "${grantSource1}", grantSourceId "${grantSourceId1}" for user "${userId2}" is "false" in DB
    check entitlement with entitlementType "${entitlementType2}" for user "${userId2}" is "false"
    ensure that entitlement with entitlementType "${entitlementType2}" and grantSource "${grantSource2}", grantSourceId "${grantSourceId2}" for user "${userId2}" is "false" in DB
    ensure there are "0" entitlements for user "${userId2}"
    ensure there are no entitlements for user "${userId2}"